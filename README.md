Fragments
=========
[![Build Status](https://travis-ci.org/rygel/fragments.svg?branch=master)](https://travis-ci.org/rygel/fragments)
[![Coverage Status](https://coveralls.io/repos/github/rygel/fragments/badge.svg?branch=master)](https://coveralls.io/github/rygel/fragments?branch=master)
[![Maven Central](http://img.shields.io/maven-central/v/io.andromeda/fragments.svg)](http://search.maven.org/#search|ga|1|io.andromeda)
[![Javadocs](http://www.javadoc.io/badge/io.andromeda/fragments.svg)](http://www.javadoc.io/doc/io.andromeda/fragments)

A pages collection engine for the [Pippo](https://github.com/decebals/pippo) Java Micro Framework. It is loosely inspired by [Poet](http://jsantell.github.io/poet/).

The main features are:
----------------------
- Markdown files with JSON or YAML Front Matter
- Global or local (per file) template definitions
- Global and local (per file) Context
- Invisible Pages (e.g. drafts)
- Generation of preview texts
- Support of multiple languages
- Expiring files (not yet implemented)

## Other Features
- Supports obfuscation of email addresses via [flexmark-java](https://github.com/vsch/flexmark-java) (in the Markdown files) as well as directly via the default context.

## Use Cases
I have often the case that I want to display collections of data with Pippo, e.g. a list of articles, a list of events, etc.
For this I have created Fragments. It holds all markdown files and creates routes for them in Pippo.

## How to use
Configure fragments.
```
 Fragments froot = new Fragments(this,"Root", "/", currentPath + "/data/fragments/root", "", "static_page", defaultContext, configuration);
```

Example of an Markdown file.

```
---
title    : My First Event
slug     : first-event
template : event
date     : 2017-01-12T12:12:12
preview  : 
order    : 
visible  : false
---
This is the first event using Fragments.
```

###  Fragment properties
| Property         | Type    | Default value           | Description                                                                                                                                                                                                                       |
|:-----------------|:--------|:------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| content          | String  | ""                      | The textual content of the fragment. If the fragment contains multiple languages, it contains the content of the current language.                                                                                                |
| defaultLanguage  | String  | ""                      | The default language of the fragment.                                                                                                                                                                                             |
| full_url         | String  | The full URL.           | The full URL of the fragment, the concatenation of protocol, domain, fragments.baseURL and fragment.url.                                                                                                                          |
| full_url_encoded | String  | The full encoded URL.   | The full URL of the fragment, the concatenation of protocol, domain, fragments.baseURL and frgment.url encoded to be used as a parameter for Facebook or Whatsapp sharing.                                                        |
| languages        | TreeMap |                         | The list of languages as defined in Pippo.                                                                                                                                                                                        |
| languagesPreview | TreeMap |                         | The list of all preview texts of the contents in the different languages.                                                                                                                                                         |
| languagesTitles  | TreeMap |                         | The list of all content texts in the different languages.                                                                                                                                                                         |
| order            | int     | autoincrement           | The order of the fragments. Can be defined via front matter. If not defined via front matter, than it is autogenerated based on alphabetic ordering of the fragment's titles.                                                     |
| preview          | String  | ""                      | The preview of the textual content of the fragment. If the fragment contains multiple languages, it contains the preview of the current language.                                                                                 |
| slug             | String  | The slug.               | The slug of the fragment. Either defined via the front matter or autogenerated.                                                                                                                                                   |
| template         | String  | via front matter        | The template for the fragment. Defined via front matter. Can overwrite the definition via Fragments on a per fragment basis.                                                                                                      |
| title            | String  | via front matter        | The title as defined via front matter. If the fragment contains multiple languages, it contains the title of the current language. To be implemented!                                                                             |
| url              | String  | The baseUrl + the slug. | The base URL + the slug of the fragment.                                                                                                                                                                                          |
| visible          | boolean | true                    | Defines if the fragment is visible or not. Default value in Java is false, which will automatically overwritten with true, if it is not defined in the front matter. For usability purposes it can be seen as defaulting to true. |

### Fragment preview marker
- preview tag inside of front matter
- ```<!--more-->``` tag inside the content. Can be written as either ```<!--more-->, <!-- more -->, <!-- more-->, <!--more -->```.

### Configuration class
Is used to configure the following properties of a Fragment:

| Property  | Type      | Default value      | Description                                                                                                                                                |
|:----------|:----------|:-------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| domain    | String    | ""                 | The domain of the website, e.g. example.com                                                                                                                |
| extension | String    | ".md"              | The extension of the markdown files.                                                                                                                       |
| protocol  | String    | "https://"         | The protocol of the website. Used for constructing the fully encoded URL.                                                                                  |
| routeType | RouteType | RouteType.ARTICLES | The route type of the Fragments object. Defaults to ARTICLES, but can be changed to Blog, which will include the date into the URL, e.g. /2017/01/14/slug. |

### Dependencies
- flexmark-java
- fastjson
- snakeyaml
- commons-io
- pippo-core
